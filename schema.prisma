generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model afiliaciones {
  id    Int     @id @default(autoincrement())
  personaId         Int?
  planId            Int?
  aseguradoraId     Int?
  numeroPoliza      String?            @db.VarChar(100)
  vigenteDesde      DateTime?          @db.Date
  vigenteHasta      DateTime?          @db.Date
  copago            Decimal?           @db.Decimal(10, 2)
  cuotaModeradora   Decimal?           @db.Decimal(10, 2)
  personasatendidas personasatendidas? @relation(fields: [personaId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "afiliaciones_ibfk_1")
  planescobertura   planescobertura?   @relation(fields: [planId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "afiliaciones_ibfk_2")
  aseguradoras      aseguradoras?      @relation(fields: [aseguradoraId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "afiliaciones_ibfk_3")

  @@index([aseguradoraId], map: "aseguradoraId")
  @@index([personaId], map: "personaId")
  @@index([planId], map: "planId")
}

model agenda {
  id               Int               @id @default(autoincrement())
  profesionalId    Int?
  unidadId         Int?
  inicio           DateTime?         @db.DateTime(0)
  fin              DateTime?         @db.DateTime(0)
  capacidad        Int?
  estado           String?           @db.VarChar(20)
  profesionales    profesionales?    @relation(fields: [profesionalId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "agenda_ibfk_1")
  unidadesatencion unidadesatencion? @relation(fields: [unidadId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "agenda_ibfk_2")

  @@index([profesionalId], map: "profesionalId")
  @@index([unidadId], map: "unidadId")
}

model arancel {
  id              Int              @id @default(autoincrement())
  prestacionId    Int?
  planId          Int?
  valorBase       Decimal?         @db.Decimal(10, 2)
  impuestos       Decimal?         @db.Decimal(10, 2)
  vigenteDesde    DateTime?        @db.Date
  vigenteHasta    DateTime?        @db.Date
  prestaciones    prestaciones?    @relation(fields: [prestacionId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "arancel_ibfk_1")
  planescobertura planescobertura? @relation(fields: [planId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "arancel_ibfk_2")

  @@index([planId], map: "planId")
  @@index([prestacionId], map: "prestacionId")
}

model archivo {
  id         Int          @id @default(autoincrement())
  fecha      DateTime?    @db.DateTime(0)
  tipo       String?      @db.VarChar(50)
  requisitos String?      @db.Text
  resultados resultados[]
}

model aseguradoras {
  id              Int               @id @default(autoincrement())
  nombre          String?           @db.VarChar(500)
  contacto        String?           @db.VarChar(255)
  estado          String?           @db.VarChar(50)
  afiliaciones    afiliaciones[]
  facturas        facturas[]
  planescobertura planescobertura[]
}

model bitacoraaccesos {
  id        Int       @id @default(autoincrement())
  usuarioId Int
  recurso   String?   @db.VarChar(50)
  accion    String?   @db.VarChar(50)
  ip        String?   @db.VarChar(50)
  userAgent String?   @db.VarChar(50)
  fecha     DateTime? @db.DateTime(0)
  usuarios  usuarios? @relation(fields: [usuarioId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "bitacoraaccesos_ibfk_1")

  @@index([usuarioId], map: "usuarioId")
}

model citas {
  id    Int     @id @default(autoincrement())
  personaId         Int?
  profesionalId     Int?
  unidadId          Int?
  inicio            DateTime?          @db.DateTime(0)
  fin               DateTime?          @db.DateTime(0)
  motivo            String?            @db.Text
  canal             String?            @db.VarChar(20)
  observaciones     String?            @db.Text
  estado            String?            @db.VarChar(20)
  personasatendidas personasatendidas? @relation(fields: [personaId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "citas_ibfk_1")
  profesionales     profesionales?     @relation(fields: [profesionalId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "citas_ibfk_2")
  unidadesatencion  unidadesatencion?  @relation(fields: [unidadId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "citas_ibfk_3")

  @@index([personaId], map: "personaId")
  @@index([profesionalId], map: "profesionalId")
  @@index([unidadId], map: "unidadId")
}

model consentimientos {
  id    Int     @id @default(autoincrement())
  personaId         Int?
  tipoProcedimiento String?            @db.VarChar(150)
  nombre            String?            @db.VarChar(150)
  fecha             DateTime?          @db.DateTime(0)
  archivoId         String?            @db.VarChar(100)
  personasatendidas personasatendidas? @relation(fields: [personaId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "consentimientos_ibfk_1")

  @@index([personaId], map: "personaId")
}

model diagnosticos {
  id    Int     @id @default(autoincrement())
  episodioId        Int?
  codigo            String?            @db.VarChar(50)
  descripcion       String?            @db.VarChar(255)
  tipo              String?            @db.VarChar(50)
  principal         Boolean?
  episodiosatencion episodiosatencion? @relation(fields: [episodioId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "diagnosticos_ibfk_1")

  @@index([episodioId], map: "episodioId")
}

model episodioprestacion {
  id                Int               @id @default(autoincrement())
  episodioId        Int
  prestacionId      Int
  profesionalId     Int?
  fechaRealizacion  DateTime?         @db.DateTime(0)
  cantidad          Int?
  valorRegistrado   String?           @db.VarChar(50)
  episodiosatencion episodiosatencion @relation(fields: [episodioId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "episodioprestacion_ibfk_1")
  prestaciones      prestaciones      @relation(fields: [prestacionId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "episodioprestacion_ibfk_2")
  profesionales     profesionales?    @relation(fields: [profesionalId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "episodioprestacion_ibfk_3")

  @@index([prestacionId], map: "prestacionId")
  @@index([profesionalId], map: "profesionalId")
}

model episodiosatencion {
  id                 Int                  @id @default(autoincrement())
  personaId          Int?
  fechaApertura      DateTime?            @db.DateTime(0)
  motivo             String?              @db.Text
  tipo               String?              @db.VarChar(50)
  estado             String?              @db.VarChar(20)
  diagnosticos       diagnosticos[]
  episodioprestacion episodioprestacion[]
  personasatendidas  personasatendidas?   @relation(fields: [personaId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "episodiosatencion_ibfk_1")
  notasclinicas      notasclinicas[]
  ordenes            ordenes[]
  prescripciones     prescripciones[]

  @@index([personaId], map: "personaId")
}

model facturaitem {
  id            Int           @id @default(autoincrement())
  facturaId     Int?
  prestacionId  Int?
  descripcion   String?       @db.VarChar(50)
  cantidad      Int?
  valorUnitario Decimal?      @db.Decimal(10, 2)
  impuestos     Decimal?      @db.Decimal(10, 2)
  total         Decimal?      @db.Decimal(10, 2)
  facturas      facturas?     @relation(fields: [facturaId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "facturaitem_ibfk_1")
  prestaciones  prestaciones? @relation(fields: [prestacionId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "facturaitem_ibfk_2")

  @@index([facturaId], map: "facturaId")
  @@index([prestacionId], map: "prestacionId")
}

model facturas {
  id    Int     @id @default(autoincrement())
  personaId         Int?
  aseguradoraId     Int?
  numero            String?            @unique(map: "numero") @db.VarChar(50)
  fechaEmision      DateTime?          @db.DateTime(0)
  subtotal          Decimal?           @db.Decimal(10, 2)
  impuestos         Decimal?           @db.Decimal(10, 2)
  total             Decimal?           @db.Decimal(10, 2)
  estado            String?            @db.VarChar(50)
  moneda            String?            @db.VarChar(10)
  facturaitem       facturaitem[]
  personasatendidas personasatendidas? @relation(fields: [personaId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "facturas_ibfk_1")
  aseguradoras      aseguradoras?      @relation(fields: [aseguradoraId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "facturas_ibfk_2")
  notificaciones    notificaciones[]
  pagos             pagos[]

  @@index([aseguradoraId], map: "aseguradoraId")
  @@index([personaId], map: "personaId")
}

model items {
  id                Int                 @id @default(autoincrement())
  nombre            String?             @db.VarChar(50)
  descripcion       String?             @db.VarChar(50)
  itemsprescripcion itemsprescripcion[]
  ordenitems        ordenitems[]
}

model itemsprescripcion {
  id             Int            @id @default(autoincrement())
  prescripcionId Int
  itemId         Int
  dosis          String?        @db.VarChar(50)
  via            String?        @db.VarChar(50)
  frecuencia     String?        @db.VarChar(50)
  duracion       String?        @db.VarChar(50)
  prescripciones prescripciones @relation(fields: [prescripcionId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "itemsprescripcion_ibfk_1")
  items          items          @relation(fields: [itemId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "itemsprescripcion_ibfk_2")

  @@index([itemId], map: "itemId")
}

model notasclinicas {
  id    Int     @id @default(autoincrement())
  episodioId        Int?
  profesionalId     Int?
  fecha             DateTime?          @db.DateTime(0)
  subjetivo         String?            @db.Text
  objetivo          String?            @db.Text
  analisis          String?            @db.Text
  plan              String?            @db.Text
  episodiosatencion episodiosatencion? @relation(fields: [episodioId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "notasclinicas_ibfk_1")
  profesionales     profesionales?     @relation(fields: [profesionalId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "notasclinicas_ibfk_2")

  @@index([episodioId], map: "episodioId")
  @@index([profesionalId], map: "profesionalId")
}

model notificaciones {
  id           Int       @id @default(autoincrement())
  usuarioId    Int?
  facturaId    Int?
  tipo         String?   @db.VarChar(50)
  plantilla    String?   @db.VarChar(100)
  destinatario String?   @db.VarChar(255)
  payload      String?   @db.Text
  estado       String?   @db.VarChar(50)
  timestamp    DateTime? @db.DateTime(0)
  usuarios     usuarios? @relation(fields: [usuarioId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "notificaciones_ibfk_1")
  facturas     facturas? @relation(fields: [facturaId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "notificaciones_ibfk_2")

  @@index([facturaId], map: "facturaId")
  @@index([usuarioId], map: "usuarioId")
}

model ordenes {
  id    Int     @id @default(autoincrement())
  episodioId        Int?
  tipo              String?            @db.VarChar(50)
  prioridad         String?            @db.VarChar(20)
  estado            String?            @db.VarChar(50)
  episodiosatencion episodiosatencion? @relation(fields: [episodioId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "ordenes_ibfk_1")
  ordenitems        ordenitems[]
  resultados        resultados[]

  @@index([episodioId], map: "episodioId")
}

model ordenitems {
  id           Int            @id @default(autoincrement())
  ordenId      Int
  itemId       Int
  descripcion  String? @db.VarChar(255)
  indicaciones String? @db.Text
  ordenes      ordenes @relation(fields: [ordenId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "ordenitems_ibfk_1")
  items        items   @relation(fields: [itemId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "ordenitems_ibfk_2")

  @@index([itemId], map: "itemId")
}

model pagos {
  id         Int       @id @default(autoincrement())
  facturaId  Int?
  fecha      DateTime? @db.DateTime(0)
  monto      Decimal?  @db.Decimal(10, 2)
  medio      String?   @db.VarChar(50)
  referencia String?   @db.VarChar(50)
  estado     String?   @db.VarChar(20)
  facturas   facturas? @relation(fields: [facturaId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "pagos_ibfk_1")

  @@index([facturaId], map: "facturaId")
}

model permisos {
  id          Int          @id @default(autoincrement())
  clave       String?      @db.VarChar(50)
  descripcion String?      @db.Text
  rolpermiso  rolpermiso[]
}

model personasatendidas {
  id                 Int                 @id @default(autoincrement())
  tipoDocumento      String?             @db.VarChar(50)
  numeroDocumento    String?             @unique(map: "numeroDocumento") @db.VarChar(50)
  nombres            String?             @db.VarChar(100)
  apellidos          String?             @db.VarChar(100)
  fechaNacimiento    DateTime?           @db.Date
  sexo               String?             @db.VarChar(10)
  correo             String?             @db.VarChar(150)
  telefono           String?             @db.VarChar(50)
  contactoEmergencia String?             @db.VarChar(255)
  direccion          String?             @db.VarChar(255)
  alergias           String?             @db.VarChar(255)
  estado             String?             @db.VarChar(20)
  afiliaciones       afiliaciones[]
  citas              citas[]
  consentimientos    consentimientos[]
  episodiosatencion  episodiosatencion[]
  facturas           facturas[]
}

model planescobertura {
  id                   Int            @id @default(autoincrement())
  aseguradoraId        Int?
  nombre               String?        @db.VarChar(100)
  condicionesGenerales String?        @db.Text
  afiliaciones         afiliaciones[]
  arancel              arancel[]
  aseguradoras         aseguradoras?  @relation(fields: [aseguradoraId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "planescobertura_ibfk_1")

  @@index([aseguradoraId], map: "aseguradoraId")
}

model prescripciones {
  id                Int                 @id @default(autoincrement())
  episodioId        Int?
  observaciones     String?             @db.Text
  itemsprescripcion itemsprescripcion[]
  episodiosatencion episodiosatencion?  @relation(fields: [episodioId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "prescripciones_ibfk_1")

  @@index([episodioId], map: "episodioId")
}

model prestaciones {
  id                 Int                  @id @default(autoincrement())
  nombre             String?              @db.VarChar(150)
  grupo              String?              @db.VarChar(50)
  requisitos         String?              @db.Text
  tiempoEstimado     Int?
  arancel            arancel[]
  episodioprestacion episodioprestacion[]
  facturaitem        facturaitem[]
}

model profesionales {
  id                  Int                  @id @default(autoincrement())
  usuarioId           Int                  
  nombres             String?              @db.VarChar(100)
  apellidos           String?              @db.VarChar(100)
  registroProfesional String?              @db.VarChar(255)
  correo              String?              @db.VarChar(150)
  telefono            String?              @db.VarChar(50)
  especialidad        String?              @db.VarChar(100)
  estado              String?              @db.VarChar(20)
  agenda              agenda[]
  citas               citas[]
  episodioprestacion  episodioprestacion[]
  notasclinicas       notasclinicas[]
  profesionalunidad   profesionalunidad[]
  usuarios            usuarios          @relation(fields: [usuarioId], references: [id])

}

model profesionalunidad {
  Id                   Int              @id @default(autoincrement())
  unidadId             Int
  profesionalId        Int
  nombre               String?          @db.VarChar(50)
  condicionesGenerales String?          @db.Text
  profesionales        profesionales    @relation(fields: [profesionalId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "profesionalunidad_ibfk_1")
  unidadesatencion     unidadesatencion @relation(fields: [unidadId], references: [id])
}

model resultados {
  id        Int      @id @default(autoincrement())
  ordenId   Int?
  archivoId Int?
  resumen   String?  @db.Text
  version   String?  @db.VarChar(20)
  fecha     DateTime @db.Date
  ordenes   ordenes? @relation(fields: [ordenId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "resultados_ibfk_1")
  archivo   archivo? @relation(fields: [archivoId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "resultados_ibfk_2")

  @@index([archivoId], map: "archivoId")
  @@index([ordenId], map: "ordenId")
}

model roles {
  id          Int          @id @default(autoincrement())
  nombre      String?      @db.VarChar(50)
  descripcion String?      @db.Text
  rolpermiso  rolpermiso[]
  usuariorol  usuariorol[]
}

model rolpermiso {
  rolId     Int
  permisoId Int
  roles     roles    @relation(fields: [rolId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "rolpermiso_ibfk_1")
  permisos  permisos @relation(fields: [permisoId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "rolpermiso_ibfk_2")

  @@id([rolId, permisoId])
  @@index([permisoId], map: "permisoId")
}

model unidadesatencion {
  id                Int                 @id @default(autoincrement())
  nombre            String?             @db.VarChar(100)
  tipo              String?             @db.VarChar(100)
  metodo            String?             @db.VarChar(150)
  direccion         String?             @db.VarChar(255)
  telefono          String?             @db.VarChar(50)
  estado            String?             @db.VarChar(20)
  agenda            agenda[]
  citas             citas[]
  profesionalunidad profesionalunidad[]
}

model usuariorol {
  usuarioId Int
  rolId     Int
  usuarios  usuarios @relation(fields: [usuarioId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "usuariorol_ibfk_1")
  roles     roles    @relation(fields: [rolId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "usuariorol_ibfk_2")

  @@id([usuarioId, rolId])
  @@index([rolId], map: "rolId")
}

model usuarios {
  id              Int               @id @default(autoincrement())
  username        String?           @unique(map: "username") @db.VarChar(50)
  email           String?           @db.VarChar(150)
  passwordHash    String?           @db.VarChar(255)
  estado          String?           @db.VarChar(20)
  fechaCreacion   DateTime?         @db.DateTime(0)
  bitacoraaccesos bitacoraaccesos[]
  notificaciones  notificaciones[]
  profesionales   profesionales[]
  usuariorol      usuariorol[]
}
